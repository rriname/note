
## IAM
サービス単位の権限を取り扱う。同じサービス内で分けられないため、IAMではなくタグ設定する（本番用・検証用のEC2をたてるなど）
ユーザーグループにまとめられる。
・IAMポリシー：JSON形式のドキュメント。configみたいなもの

・ROOTユーザー：IAMではない。最初に作成されるIDアカウント
・管理者権限：IAM操作できる、ROOTの次に強い
・パワーユーザー：IAM以外の全権限を持つ

IAMリソース：IAMで取り扱うすべて
アイデンティティ：ユーザー、グループ、ロール
エンティティ：ユーザー、ロール

### IAMポリシーの種類
- 管理ポリシー
使いまわしできる。バージョニング・ロールバックがされるので、ポリシー自体を変更しても、適用されているユーザーに自動更新されない。
  -  AWS管理ポリシー：AWSが用意しているテンプレート。
  - カスタマー管理ポリシー：カスタム作成できるもの。GUI作成できる
- インラインポリシー：使いまわしができない、１対１のポリシー。
  １つのアイデンティティにだけ適用するもの、アイデンティティ自身の一部。

### IAMポリシーのタイプ
- ユーザーベース
  前述
- リソースベース
  AWSリソース事態にアタッチされる。記述式は同じ、インラインポリシーになる。

### ポリシー効果
- 許可ポリシー：前述
- 信頼ポリシー：許可前に、ロールとして権限を委譲する設定。信頼後に許可。
  一時的に外部ユーザへアクセス権限を渡すときとか。監査人など。

### 他ツール
- IAMアクセスアナライザー：外部アクセスのチェック。
リソースポリシーを見て、信頼外からアクセスがあるか見る
- IAMアクセスアドバイザー：＋愛撫アクセスの確認。
IAMユーザーのリソースとアクセス日時を見る
- Credeential Report：認証情報レポート
- AWS Config：変更履歴、構成変更を管理する。

### ベストプラクティス
- MFA(多要素認証)が必要。ROOT必須、他も必要
- 最少特権アクセスを許可する
- IAMアクセスアナライザをちゃんと使おうね（外部チェックしよう

### 権限を貸すには？
※AWS STS(Security Token Service)の一部。
「AWSサービスに対して何かしら操作したい時に、一時的に操作する権利(Token)を発行する」機能で、クロスアカウントアクセスに使用。
AWSアカウントのIAMロールを、別のアカウントのユーザーやサービスが一時的に引き受けることを可能にする。
AがBにAssumeRoleを与える場合、Aのロールを「借りている」感覚。
https://zenn.dev/frusciante/articles/28cd351fe9de60

# ハンズオン
ポリシーシュミレータ：作成したポリシーが適切に設定されてるか？をシミュレーションしてくれる。

